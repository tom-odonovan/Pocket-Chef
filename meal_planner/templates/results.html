{% extends 'base.html' %}
{% block title %}Search Recipes{% endblock %}

{% block content %}
<main class="results">
    
    <div class="search-container">
        <form class="search-bar" method="POST" action="/results">
            <input class="search-input" type="text" placeholder="Search recipes" name="search">
            <input class="submit search-button" type="submit" value="Search">
        </form>

        <h2>Showing results for '{{ search }}'</h2>
        <div class="results_container" id="results_container"></div>
    </div>
</main>
{% endblock %}

{% block script %}
{{ super() }}
<script>
    let search_results = '{{ search_results | tojson }}'
    search_results = JSON.parse(search_results)
    console.log(search_results)


    let results_container = document.getElementById('results_container')
        for (result in search_results) {
            let result_container = document.createElement('div')
            result_container.className = 'result_container'
            results_container.appendChild(result_container)

            let thumbnail = document.createElement('img')
            thumbnail.className = 'thumbnail'
            thumbnail.setAttribute('src', `${search_results[result]['image']}`)
            result_container.appendChild(thumbnail)

            let recipe = document.createElement('a')
            let title = search_results[result]['title']
            recipe.innerText = title
            recipe.setAttribute('method', 'POST')
            let recipe_id = search_results[result]['id']
            recipe.setAttribute('href', `/recipe?id=${recipe_id}`)
            recipe.setAttribute('value', recipe_id)
            result_container.appendChild(recipe)
        }
</script>
{% endblock %}